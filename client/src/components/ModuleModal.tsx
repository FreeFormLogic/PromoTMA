import { Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription } from "@/components/ui/dialog";
import { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card";
import { Badge } from "@/components/ui/badge";
import { Button } from "@/components/ui/button";
import { Tabs, TabsContent, TabsList, TabsTrigger } from "@/components/ui/tabs";
import { Progress } from "@/components/ui/progress";
import { 
  CheckCircle,
  Zap,
  Target,
  DollarSign,
  Users,
  ArrowRight,
  Rocket,
  Shield,
  BarChart3,
  TrendingUp,
  Play
} from "lucide-react";
import { BeforeAfterDemo } from "./BeforeAfterDemo";
import { ModulePainPoints } from "./ModulePainPoints";

// Import individual module images
import ecommerceImage from "@assets/generated_images/E-commerce_product_catalog_interface_bf1d7b3b.png";
import shoppingCartImage from "@assets/generated_images/Shopping_cart_mobile_interface_60e8b905.png";
import paymentImage from "@assets/generated_images/Automated_payment_processing_380a86a6.png";
import crmImage from "@assets/generated_images/CRM_customer_management_1b22c7f6.png";
import inventoryImage from "@assets/generated_images/Inventory_management_system_71cf0ab5.png";
import reviewsImage from "@assets/generated_images/Review_and_rating_system_29779a06.png";
import marketingImage from "@assets/generated_images/Marketing_analytics_dashboard_db9f02b6.png";
import loyaltyImage from "@assets/generated_images/Loyalty_gamification_interface_1cba6de5.png";
import educationImage from "@assets/generated_images/Online_learning_platform_b4311535.png";
import bookingImage from "@assets/generated_images/Appointment_booking_calendar_ea7eefd6.png";
import fintechImage from "@assets/generated_images/Digital_payment_processing_226f7e9b.png";
import contentImage from "@assets/generated_images/Content_management_system_46fe7fd7.png";
import socialImage from "@assets/generated_images/Social_media_feed_bb392294.png";
import videoImage from "@assets/generated_images/Video_streaming_platform_b2344ddf.png";
import chatImage from "@assets/generated_images/Live_chat_support_3a049e0e.png";
import notificationImage from "@assets/generated_images/Push_notification_center_fc8679f4.png";
import referralImage from "@assets/generated_images/Referral_program_dashboard_67a246f6.png";
import webinarImage from "@assets/generated_images/Webinar_platform_interface_08798c44.png";
import qrPaymentImage from "@assets/generated_images/QR_code_payment_bb3e760b.png";
import walletImage from "@assets/generated_images/Multi-currency_wallet_3d2e930e.png";
import galleryImage from "@assets/generated_images/Photo_gallery_interface_6bd7c076.png";
import podcastImage from "@assets/generated_images/Podcast_platform_interface_9dd5dba9.png";
import apiImage from "@assets/generated_images/API_integration_dashboard_093d07e8.png";
import trackingImage from "@assets/generated_images/Order_tracking_interface_3f251983.png";
import discountImage from "@assets/generated_images/Discount_system_interface_f78c73cf.png";
import corporateImage from "@assets/generated_images/Corporate_portal_interface_513aeefc.png";
import surveyImage from "@assets/generated_images/Survey_feedback_interface_3627f690.png";
import gamificationImage from "@assets/generated_images/Gamification_achievement_system_98016851.png";
import subscriptionImage from "@assets/generated_images/Subscription_management_interface_fa28e3e6.png";
import calendarImage from "@assets/generated_images/Event_calendar_interface_d83b440e.png";
import exportImage from "@assets/generated_images/Data_export_interface_b4896729.png";
import invoiceImage from "@assets/generated_images/Invoice_generation_system_095a3194.png";
import supportImage from "@assets/generated_images/Support_ticket_system_9757c018.png";
import analyticsImage from "@assets/generated_images/User_behavior_analytics_84bd440f.png";
import deliveryImage from "@assets/generated_images/Delivery_tracking_map_778e4633.png";
import certificateImage from "@assets/generated_images/Digital_certificate_system_f7dc8e8b.png";
import aiContentImage from "@assets/generated_images/AI_content_generation_ec932f54.png";
import leadImage from "@assets/generated_images/Lead_management_system_28d5ec63.png";
import homeworkImage from "@assets/generated_images/Homework_assignment_platform_4253b9e8.png";
import emailMarketingImage from "@assets/generated_images/Email_marketing_campaign_420ae8af.png";
import liveStreamImage from "@assets/generated_images/Live_streaming_interface_acbc10aa.png";
import formBuilderImage from "@assets/generated_images/Form_builder_interface_373046a0.png";
import queueImage from "@assets/generated_images/Queue_management_system_64d9ab31.png";
import socialSharingImage from "@assets/generated_images/Social_sharing_interface_e0a57791.png";
import videoCallImage from "@assets/generated_images/Video_call_interface_345c3934.png";
import libraryImage from "@assets/generated_images/Digital_library_interface_588c6eee.png";
import cryptoWalletImage from "@assets/generated_images/Cryptocurrency_wallet_interface_4ff3d809.png";
import progressImage from "@assets/generated_images/Progress_tracking_dashboard_2d5a65bd.png";
import specialistImage from "@assets/generated_images/Specialist_scheduling_interface_066105d1.png";
import storiesImage from "@assets/generated_images/Interactive_stories_mobile_interface_fce6f857.png";

// Define image aliases for consistent mapping
const showcaseSystemImage = ecommerceImage;
const cartSyncImage = shoppingCartImage;
const paymentAutomationImage = paymentImage;
const customerCrmImage = crmImage;
const inventoryControlImage = inventoryImage;
const reviewSystemImage = reviewsImage;
const salesFunnelImage = marketingImage;
const recommendationEngineImage = marketingImage;
const abTestingImage = marketingImage;
const loyaltyProgramImage = loyaltyImage;
const gamificationSystemImage = gamificationImage;
const lmsEducationImage = educationImage;
const videoCourseImage = educationImage;
const bookingCalendarImage = bookingImage;
const realtimeBookingImage = bookingImage;
const telegramStarsImage = fintechImage;
const multiCurrencyWalletImage = walletImage;
const newsFeedImage = socialImage;
const blogEditorImage = contentImage;
const videoStreamingImage = videoImage;

interface ModuleModalProps {
  module: any;
  isOpen: boolean;
  onClose: () => void;
}

// Individual module images for specific modules
const moduleImages: Record<string, string> = {
  // E-COMMERCE И ПРОДАЖИ
  "Витрина товаров с AI-описаниями и умными фильтрами": showcaseSystemImage,
  "Корзина с сохранением между сессиями": cartSyncImage,
  "Автоматический прием платежей": paymentAutomationImage,
  "CRM для управления клиентами": customerCrmImage,
  "Управление складом и остатками": inventoryControlImage,
  "Система отзывов и рейтингов товаров": reviewSystemImage,
  
  // МАРКЕТИНГ И АНАЛИТИКА
  "Система лидов и воронки продаж": salesFunnelImage,
  "Персонализированные рекомендации": recommendationEngineImage,
  "A/B тестирование интерфейса": abTestingImage,
  
  // ВОВЛЕЧЕНИЕ И ЛОЯЛЬНОСТЬ
  "Программа лояльности с начислением баллов": loyaltyProgramImage,
  "Ежедневные задания и streak-система": gamificationSystemImage,
  
  // ОБРАЗОВАНИЕ И ОБУЧЕНИЕ
  "LMS платформа с прогрессом и сертификатами": lmsEducationImage,
  "Платформа курсов с видео и интерактивными тестами": videoCourseImage,
  
  // СЕРВИСЫ И БРОНИРОВАНИЕ
  "Календарь записи с автоматическим подтверждением": bookingCalendarImage,
  "Онлайн-запись с календарем в реальном времени": realtimeBookingImage,
  
  // ФИНТЕХ И ПЛАТЕЖИ
  "Прием Telegram Stars (0% комиссия)": telegramStarsImage,
  "Мультивалютный кошелек с конвертацией": multiCurrencyWalletImage,
  "QR-коды для быстрых покупок в офлайне": qrPaymentImage,
  
  // КОНТЕНТ И МЕДИА
  "Лента новостей с алгоритмической подачей": newsFeedImage,
  "Встроенный блог с редактором и SEO": blogEditorImage,
  "Стриминг видео с адаптивным качеством": videoStreamingImage,
  "Кружочки сторис с интерактивными элементами": storiesImage,
  
  // ВОВЛЕЧЕНИЕ И ЛОЯЛЬНОСТЬ
  "Push-уведомления с персонализацией по поведению": notificationImage,
  "Система скидок и промокодов": discountImage,
  "Система статусов заказов с real-time трекингом": trackingImage,
  "Интеграция с СДЭК, Boxberry, Почтой России": deliveryImage,
  "Реферальная система с вознаграждениями": referralImage,
  
  // ОБРАЗОВАНИЕ И ОБУЧЕНИЕ
  "Вебинары и live-стримы с чатом": webinarImage,
  
  // ИНТЕГРАЦИИ И API
  "Чат-боты с AI для автоматизации поддержки": chatImage,
  "Синхронизация с внешними сервисами": apiImage,
  "Экспорт данных в популярные форматы": exportImage,
  
  // B2B И КОРПОРАТИВНЫЕ СЕРВИСЫ
  "Корпоративный портал 'в кармане'": corporateImage,
  
  // More E-COMMERCE modules
  
  // More MARKETING modules  
  "Дашборд бизнес-аналитики с real-time метриками": leadImage,
  "Аналитика поведения пользователей": analyticsImage,
  "Опросы и сбор обратной связи": surveyImage,
  
  // More EDUCATION modules
  "Система сертификатов и дипломов с верификацией": certificateImage,
  "Домашние задания с проверкой и обратной связью": homeworkImage,
  "Трекинг прогресса обучения и статистика": trackingImage,
  
  // More FINTECH modules
  "Система подписок и рекуррентных платежей": subscriptionImage,
  "Выставление счетов и актов для юрлиц": invoiceImage,
  
  // More CONTENT modules
  "Галерея фото/видео с категориями": galleryImage,
  "Подкасты и аудиоконтент с плейлистами": podcastImage,
  "Генерация контента через AI (тексты, изображения)": aiContentImage,
  
  // More ENGAGEMENT modules
  "Система достижений и бейджей за активность": gamificationImage,
  
  // More SERVICES modules
  "Расписание занятий с напоминаниями": calendarImage,
  "Управление расписанием специалистов": calendarImage,
  
  // More INTEGRATION modules
  "Техподдержка через тикет-систему": supportImage,
  "Конструктор форм с логикой и валидацией": formBuilderImage,
  
  // Additional E-COMMERCE modules
  "Карточка товара с 360° галереей и видео-обзорами": galleryImage,
  "AI-персонализация с умными рекомендациями": aiContentImage,
  
  // Additional MARKETING modules
  "Email и SMS рассылки с сегментацией": emailMarketingImage,
  "Интеграция с соцсетями для вирального роста": socialSharingImage,
  
  // Additional LOYALTY modules
  "Social Proof с живыми уведомлениями о покупках": socialSharingImage,
  
  // Additional EDUCATION modules
  "Интерактивные тесты и квизы с мгновенными результатами": formBuilderImage,
  "Видео-уроки с таймкодами и заметками": videoImage,
  
  // Additional SERVICES modules
  "Система управления очередями": queueImage,
  "Бронирование номеров и столиков в реальном времени": bookingImage,
  "Система напоминаний о записи": notificationImage,
  
  // Additional FINTECH modules
  "P2P переводы между пользователями": walletImage,
  "Система кредитования и рассрочек": subscriptionImage,
  "Интеграция с банковскими API": apiImage,
  "Криптовалютные платежи и токены": cryptoWalletImage,
  
  // Additional CONTENT modules
  "Система комментариев с модерацией": socialImage,
  "Фото и видеогалереи с тегированием": galleryImage,
  "Документооборот и файлообменник": libraryImage,
  
  // Additional INTEGRATION modules
  "Интеграция с 1С и другими учетными системами": apiImage,
  "Веб-хуки для уведомлений": notificationImage
};

const categoryImages: Record<string, string> = {
  "E-COMMERCE И ПРОДАЖИ": ecommerceImage,
  "МАРКЕТИНГ И АНАЛИТИКА": marketingImage,
  "ВОВЛЕЧЕНИЕ И ЛОЯЛЬНОСТЬ": loyaltyImage,
  "ОБРАЗОВАНИЕ И ОБУЧЕНИЕ": educationImage,
  "СЕРВИСЫ И БРОНИРОВАНИЕ": bookingImage,
  "ФИНТЕХ И ПЛАТЕЖИ": fintechImage,
  "КОНТЕНТ И МЕДИА": contentImage,
  "ИНТЕГРАЦИИ И API": contentImage,
  "B2B И КОРПОРАТИВНЫЕ СЕРВИСЫ": corporateImage
};

const moduleFeatures: Record<string, any> = {
  "Витрина товаров с AI-описаниями и умными фильтрами": {
    description: "Революционное решение для каталогизации и презентации товаров в Telegram Mini App, значительно повышающее конверсию:",
    features: [
      "**Нейросетевые описания товаров**: Автоматическая генерация привлекательных продающих текстов для каждой позиции на основе характеристик, что сокращает время наполнения каталога на 90%",
      "**Интеллектуальная система фильтрации**: 20+ типов фильтров с автоматической настройкой релевантности под конкретные категории товаров, адаптированные под компактный интерфейс Telegram",
      "**Визуальный поиск**: Загрузка фотографии товара для быстрого поиска аналогов в каталоге с точностью распознавания до 95%, работает прямо в чате Telegram",
      "**Динамический каталог**: Автоматическое ранжирование товаров на основе пользовательских предпочтений и популярности среди аудитории Telegram",
      "**Персонализация витрины**: Адаптация отображаемого ассортимента под интересы каждого пользователя на основе его активности в Mini App"
    ],
    impact: "Технология использует алгоритмы компьютерного зрения и обработки естественного языка для создания максимально удобного и персонализированного опыта покупок в Telegram, увеличивая конверсию до 35%.",
  },
  "Корзина с сохранением между сессиями": {
    description: "Интеллектуальная система управления процессом покупки в Telegram, существенно сокращающая количество брошенных корзин:",
    features: [
      "**Синхронизация с аккаунтом Telegram**: Мгновенное сохранение и восстановление состава корзины при повторном открытии Mini App",
      "**Облачное хранение данных**: Сохранение содержимого корзины до 30 дней для пользователей Telegram",
      "**Восстановление прерванных сессий**: Автоматическое восстановление состава корзины после закрытия приложения или перезагрузки устройства",
      "**Интеллектуальные напоминания**: Персонализированные уведомления о незавершенных покупках через личные сообщения Telegram с точечным таймингом",
      "**Аналитика поведения**: Выявление паттернов, приводящих к отказу от покупки, для оптимизации воронки продаж в Mini App"
    ],
    impact: "Решение снижает процент брошенных корзин на 35-45%, что напрямую влияет на увеличение конверсии и среднего чека магазина в Telegram.",
  },
  "Автоматический прием платежей": {
    description: "Универсальная платежная экосистема для Telegram Mini Apps с максимальным охватом методов оплаты и встроенной защитой:",
    features: [
      "**Интеграция с Telegram Payments**: Быстрая оплата через встроенные в Telegram платежные методы без перехода на сторонние сайты",
      "**Мультиплатформенный прием платежей**: Поддержка 15+ способов оплаты включая карты всех мировых платежных систем, электронные кошельки, мобильные платежи, СБП и Telegram Stars",
      "**Защита от мошенничества**: Многоуровневая система безопасности с ML-алгоритмами для выявления подозрительных операций в реальном времени",
      "**Автоматические возвраты**: Мгновенная обработка возвратов и частичных возмещений с минимальным участием менеджера",
      "**Умные платежные формы**: Адаптивный дизайн с минимизацией полей для быстрой оплаты прямо в Telegram"
    ],
    impact: "Комплексное решение увеличивает конверсию платежей на 23% за счет снижения трения при оплате и использования доверия пользователей к экосистеме Telegram.",
  },
  "Карточка товара с 360° галереей и видео-обзорами": {
    description: "Интерактивная презентация товаров нового поколения для максимального вовлечения покупателей в Telegram:",
    features: [
      "**3D-просмотр товаров**: Интерактивное вращение на 360° с плавным масштабированием и оптимизированным разрешением для быстрой загрузки в Telegram Mini App",
      "**Видео-демонстрации**: Встроенный плеер для просмотра обзоров и инструкций без выхода из Telegram, с автоматической адаптацией качества видео под скорость соединения",
      "**HD-зуммирование**: Детальное рассмотрение фактуры материалов и мельчайших деталей товара с 20-кратным увеличением прямо в интерфейсе мессенджера",
      "**AR-примерка**: Визуализация мебели, одежды и аксессуаров в реальном пространстве через камеру устройства с мгновенным доступом из Telegram",
      "**Интерактивные хотспоты**: Выделение и описание ключевых особенностей товара в интерактивном режиме для мгновенного изучения продукта"
    ],
    impact: "Внедрение 3D-визуализации и AR-технологий в Telegram Mini App увеличивает конверсию в покупку на 40% и снижает количество возвратов на 25% благодаря более точному представлению о товаре.",
  },
  "CRM для управления клиентами": {
    features: [
      "360° профиль клиента: полная история покупок, предпочтений и взаимодействий с Mini App",
      "Автоматическая сегментация: распределение клиентов по поведенческим группам для персональных кампаний",
      "Жизненный цикл клиента: отслеживание этапов воронки и автоматические действия для каждого этапа",
      "Интеграция с внешними CRM: синхронизация данных с AmoCRM, Битрикс24, HubSpot",
      "Прогнозирование оттока: ML-алгоритмы для предсказания риска потери клиента и превентивные меры"
    ],
  },
  "Управление складом и остатками": {
    features: [
      "Синхронизация в реальном времени: автоматическое обновление остатков с 1С и складскими системами",
      "Умное резервирование: автоматическая блокировка товаров при добавлении в корзину Mini App на 30 минут",
      "Предиктивные уведомления: алерты о критически низких остатках с учетом скорости продаж",
      "Прогнозирование спроса: AI-анализ трендов для оптимизации закупок на основе данных из Telegram",
      "ABC-анализ товаров: автоматическая категоризация по прибыльности и оборачиваемости"
    ],
  },
  "Система отзывов и рейтингов товаров": {
    features: [
      "AI-модерация контента: автоматическая проверка отзывов на соответствие политикам и выявление фейковых отзывов",
      "Мультимедийные отзывы: возможность прикрепления фото и видео товаров прямо через Telegram Mini App",
      "Система репутации: ранжирование покупателей по качеству и полезности их отзывов",
      "Умные уведомления: автоматические алерты менеджерам о негативных отзывах для быстрого реагирования",
      "Анализ тональности: AI-определение настроения клиентов для выявления проблемных товаров"
    ],
  },
  "Система лидов и воронки продаж": {
    features: [
      "Многоступенчатый трекинг: полное отслеживание пути клиента от первого касания до конверсии в Telegram Mini App",
      "AI-скоринг лидов: автоматическая оценка качества и готовности к покупке на основе поведенческих факторов",
      "Интеллектуальные воронки: динамическая адаптация сценариев взаимодействия под каждый сегмент аудитории",
      "Мультиканальная атрибуция: точное определение источника конверсии с учетом всех точек контакта в Telegram",
      "Предиктивная аналитика: прогнозирование вероятности закрытия сделки и оптимального времени контакта"
    ],
  },
  "AI-персонализация с умными рекомендациями": {
    description: "Продвинутая система машинного обучения, создающая уникальный опыт для каждого клиента в Telegram Mini App:",
    features: [
      "**Комплексный анализ поведения**: Обработка более 50 факторов взаимодействия пользователя с Mini App для создания точного профиля предпочтений",
      "**Динамическая персонализация**: Автоматическая адаптация контента, предложений и интерфейса под каждого пользователя Telegram",
      "**Предиктивные рекомендации**: Прогнозирование потенциального интереса к товарам с точностью до 85%",
      "**Многоуровневая сегментация**: Распределение пользователей по микросегментам для таргетированных маркетинговых кампаний через Telegram",
      "**Самообучающиеся алгоритмы**: Постоянное улучшение качества рекомендаций на основе обратной связи и результатов взаимодействия в Mini App"
    ],
    impact: "Персонализация увеличивает показатель конверсии в Telegram Mini App на 30%, средний чек на 20% и повышает лояльность клиентов благодаря релевантным предложениям.",
  },
  "A/B тестирование интерфейсов и контента": {
    description: "Научный подход к оптимизации конверсии Telegram Mini App через экспериментальную проверку гипотез:",
    features: [
      "**Многовариантное тестирование**: Одновременное сравнение до 10 версий элементов интерфейса или контента в Mini App",
      "**Статистическая достоверность**: Автоматический расчет необходимого размера выборки и определение победителя с заданным уровнем значимости",
      "**Таргетированные эксперименты**: Возможность тестирования на определенных сегментах аудитории Telegram",
      "**Визуальный редактор**: Создание вариаций без необходимости привлечения программистов",
      "**Комплексная аналитика**: Оценка влияния изменений не только на ближайшую конверсию, но и на ключевые бизнес-показатели Mini App"
    ],
    impact: "Систематическое A/B тестирование позволяет добиться роста конверсии Telegram Mini App до 30% в течение 3-6 месяцев экспериментов.",
  },
  "Программа лояльности с начислением баллов": {
    description: "Комплексная система удержания клиентов через мотивационные механизмы и награды в Telegram Mini App:",
    features: [
      "**Многоуровневая система лояльности**: От стартового до VIP уровня с эксклюзивными привилегиями в Telegram Mini App",
      "**Гибкая механика начислений**: Настраиваемые правила за покупки, активность, рефералов и социальные действия в Telegram",
      "**Геймификация процесса**: Достижения, челленджи и соревнования между пользователями Telegram",
      "**Персонализированные награды**: Индивидуальные бонусы на основе предпочтений и истории покупок",
      "**Кросс-платформенные баллы**: Единая система лояльности для Mini App и других каналов продаж"
    ],
    impact: "Программа лояльности увеличивает количество повторных покупок на 40% и повышает средний чек на 15%, используя игровые механики для удержания клиентов в экосистеме Telegram.",
  },
  "Ежедневные задания и streak-система": {
    description: "Геймификация пользовательского опыта через систему ежедневных заданий в Telegram Mini App:",
    features: [
      "**Адаптивные задания**: Персонализированные квесты на основе интересов и активности пользователя в Telegram",
      "**Streak-механика**: Мотивационная система ежедневных заходов с растущими наградами за постоянство",
      "**Социальные челленджи**: Групповые задания для друзей в Telegram с командными наградами",
      "**Умные напоминания**: Персонализированные уведомления о заданиях через Telegram Bot в оптимальное время",
      "**Прогрессия сложности**: Динамическое усложнение заданий по мере роста навыков пользователя"
    ],
    impact: "Ежедневные задания увеличивают время нахождения в Mini App на 45% и повышают частоту использования на 70%, создавая привычку и постоянную вовлеченность пользователей в экосистеме Telegram.",
  },
  "LMS платформа с прогрессом и сертификатами": {
    features: [
      "Модульная архитектура курсов: гибкая система уроков с адаптивными сценариями обучения в Telegram Mini App",
      "Интеллектуальный трекинг: детальная аналитика прогресса с выявлением проблемных тем и рекомендациями",
      "Блокчейн-сертификаты: верифицируемые цифровые дипломы с защитой от подделки",
      "Микрообучение: короткие уроки по 5-10 минут, оптимизированные для изучения в мобильном формате",
      "Социальное обучение: групповые проекты и обсуждения в Telegram чатах с наставниками"
    ],
  },
  "Платформа курсов с видео и интерактивными тестами": {
    features: [
      "HD видеоплеер с закладками и заметками",
      "Адаптивные тесты под уровень знаний",
      "Система домашних заданий с автопроверкой",
      "Видеозвонки для групповых занятий",
      "Аналитика успеваемости студентов"
    ],
  },
  "Календарь записи с автоматическим подтверждением": {
    description: "Автоматизированная система планирования встреч и услуг через Telegram Mini App:",
    features: [
      "**Интеллектуальное планирование**: Автоматическое предложение оптимального времени на основе загрузки специалистов",
      "**Telegram-интеграция**: Запись на услуги прямо через Mini App с мгновенным подтверждением в чате",
      "**Умные напоминания**: Персонализированные уведомления клиентам за 24ч, 2ч и 15 мин до встречи",
      "**Система отмен и переносов**: Гибкие правила изменения записей с автоматическим перераспределением времени",
      "**Аналитика загруженности**: Оптимизация расписания специалистов на основе статистики записей"
    ],
    impact: "Автоматизация записи сокращает время менеджеров на планирование на 80% и снижает количество неявок на 35% благодаря системе напоминаний через Telegram.",
  },
  "Онлайн-запись с календарем в реальном времени": {
    features: [
      "Real-time синхронизация: мгновенное отображение свободных слотов с учетом всех изменений в расписании",
      "Персональный выбор специалистов: фильтрация мастеров по рейтингу, специализации и доступности в Mini App",
      "Динамическое ценообразование: автоматический расчет стоимости с учетом услуг, времени и специалиста",
      "Гибкая система предоплат: возможность внесения гарантийного депозита через Telegram Payments",
      "Умные напоминания: персонализированные push-уведомления за 24ч, 2ч и 15 мин до записи"
    ],
  },
  "Прием Telegram Stars (0% комиссия)": {
    description: "Нативный метод оплаты для Telegram Mini App с нулевой комиссией и максимальным удобством:",
    features: [
      "**Нативная интеграция**: Полная интеграция с системой Telegram Stars без дополнительных платежных шлюзов",
      "**Мгновенные транзакции**: Зачисление средств происходит мгновенно после оплаты в Mini App",
      "**Глобальный охват**: Прием платежей от пользователей Telegram со всего мира без ограничений",
      "**Упрощенная конверсия**: Автоматический перевод Stars в фиатную валюту по текущему курсу",
      "**Максимальное доверие**: Использование встроенной экосистемы Telegram для повышения конверсии платежей"
    ],
    impact: "Telegram Stars повышают конверсию оплат на 40% благодаря отсутствию необходимости покидать привычную среду Telegram и нулевым комиссиям для продавца.",
  },
  "Мультивалютный кошелек с конвертацией": {
    description: "Универсальное финансовое решение для работы с различными валютами через Telegram Mini App:",
    features: [
      "**Глобальная поддержка валют**: Работа с 50+ фиатными валютами и ТОП-20 криптовалют в одном Telegram Mini App",
      "**Умная конвертация**: Автоматический выбор оптимального курса из нескольких источников для минимизации комиссий",
      "**P2P обмен**: Прямые сделки между пользователями Telegram с эскроу-гарантиями",
      "**Мгновенные переводы**: Внутрисистемные транзакции за доли секунды без банковских задержек",
      "**Crypto Bridge**: Интеграция с основными блокчейн-сетями для работы с DeFi прямо в Telegram"
    ],
    impact: "Мультивалютность расширяет аудиторию на 85% и снижает барьеры входа для международных клиентов, максимально используя глобальный охват Telegram.",
  },
  "QR-коды для быстрых покупок в офлайне": {
    description: "Мост между физическими точками продаж и Telegram Mini App для омниканального опыта:",
    features: [
      "**Универсальная QR-система**: Генерация динамических кодов для товаров, акций и скидок с мгновенным обновлением",
      "**Omnichannel-интеграция**: Связывание офлайн-покупок с профилем клиента в Telegram Mini App",
      "**Быстрая оплата**: Сканирование кода и оплата прямо через Telegram без установки дополнительных приложений",
      "**Контекстные предложения**: Показ релевантных товаров и скидок на основе текущих покупок в офлайн-точке",
      "**Детальная аналитика**: Трекинг конверсии от офлайн-активности к онлайн-покупкам в Mini App"
    ],
    impact: "QR-интеграция повышает конверсию в офлайн-точках на 25% и создает единую экосистему покупок, объединяющую физический мир с возможностями Telegram.",
  },
  "Лента новостей с алгоритмической подачей": {
    description: "Интеллектуальная система контент-маркетинга для повышения вовлеченности в Telegram Mini App:",
    features: [
      "**AI-курация контента**: Автоматическое создание персонализированной ленты на основе интересов пользователя Telegram",
      "**Умная модерация**: Автоматическое выявление нежелательного контента с точностью 98%",
      "**Вирусная механика**: Система лайков, репостов и комментариев для увеличения вовлеченности в Mini App",
      "**Трендинг-алгоритмы**: Выявление популярного контента в реальном времени для поднятия в ленте",
      "**Cross-platform публикация**: Автоматическое распространение контента в связанные Telegram каналы"
    ],
    impact: "Персонализированная лента увеличивает время в приложении на 60% и повышает вовлеченность аудитории на 75%, создавая постоянную связь с брендом через Telegram.",
  },
  "Встроенный блог с редактором и SEO": {
    description: "Полноценная платформа для контент-маркетинга внутри Telegram Mini App:",
    features: [
      "**Профессиональный WYSIWYG-редактор**: Создание статей с медиафайлами прямо в Telegram Mini App",
      "**Автоматическая SEO-оптимизация**: Генерация мета-тегов, sitemap и структурированной разметки для поисковиков",
      "**Умная система тегов**: Автоматическое предложение релевантных тегов на основе содержания статьи",
      "**Модерация комментариев**: AI-фильтрация спама и токсичных комментариев в реальном времени",
      "**Детальная аналитика**: Трекинг источников трафика, времени чтения и популярности контента"
    ],
    impact: "Встроенный блог увеличивает органический трафик на 80% и повышает экспертность бренда, удерживая читателей в экосистеме Telegram через качественный контент.",
  },
  "Стриминг видео с адаптивным качеством": {
    features: [
      "Адаптивный битрейт: автоматическая подстройка качества видео от 240p до 4K в зависимости от скорости интернета",
      "Глобальная CDN-сеть: минимальные задержки воспроизведения для пользователей Telegram по всему миру",
      "DRM-защита контента: многоуровневая система защиты от несанкционированного копирования и распространения",
      "Продвинутая аналитика: детальная статистика просмотров, удержания аудитории и поведенческих паттернов",
      "Монетизация контента: гибкие модели подписок, разовых покупок и рекламных вставок в Mini App"
    ],
  },
  "Push-уведомления с персонализацией по поведению": {
    description: "Интеллектуальная система уведомлений для максимальной конверсии через Telegram:",
    features: [
      "**Умная сегментация**: Автоматическое разделение пользователей по 20+ поведенческим параметрам для точного таргетинга",
      "**Триггерные уведомления**: Автоматические сообщения при брошенной корзине, неактивности, новых товарах и других событиях",
      "**A/B тестирование коммуникаций**: Оптимизация заголовков, текстов и времени отправки для максимальной эффективности",
      "**Персональный таймминг**: Определение оптимального времени отправки для каждого клиента на основе его активности в Telegram",
      "**Детальная аналитика воронки**: Трекинг открытий, кликов и конверсий в покупки с расчетом ROI каждой кампании"
    ],
    impact: "Персонализированные уведомления повышают open rate до 85% и увеличивают повторные покупки на 55%, эффективно возвращая пользователей в Telegram Mini App.",
  },
  "Система скидок и промокодов": {
    description: "Гибкий инструмент управления ценообразованием для стимулирования продаж в Telegram Mini App:",
    features: [
      "**Многоуровневые скидки**: Создание сложных правил с комбинированием различных условий активации",
      "**Временные ограничения**: Настройка промокодов с точным периодом действия вплоть до минут",
      "**Персональные предложения**: Генерация уникальных одноразовых промокодов для конкретных пользователей Telegram",
      "**Геотаргетинг скидок**: Автоматическое применение региональных предложений",
      "**Аналитика эффективности**: Детальные отчеты по ROI каждой промо-акции"
    ],
    impact: "Умная система скидок повышает конверсию на 20% и увеличивает средний чек на 15%, эффективно управляя ценовой политикой через механизмы Telegram.",
  },
  "Система статусов заказов с real-time трекингом": {
    description: "Прозрачная система мониторинга движения заказов от оформления до получения через Telegram:",
    features: [
      "**Детализированный процесс статусов**: 8-10 этапов обработки заказа с подробными уведомлениями для клиента через Telegram",
      "**GPS-трекинг курьеров**: Отображение текущего местоположения курьера на карте с прогнозируемым временем прибытия прямо в Mini App",
      "**Предиктивная аналитика доставки**: Расчет точного времени доставки с учетом загруженности дорог и статистических данных",
      "**Мгновенные уведомления**: Автоматическая отправка сообщений о смене статуса заказа через Telegram Bot",
      "**Интеграция с логистическими сервисами**: Автоматическое получение трек-номеров и статусов от транспортных компаний"
    ],
    impact: "Система повышает удовлетворенность клиентов на 47% благодаря полной информированности и снижает количество обращений в службу поддержки на 70%, сохраняя пользователей в экосистеме Telegram.",
  },
  "Управление доставкой с СДЭК, Boxberry, Почтой России": {
    description: "Комплексная автоматизация логистических процессов для Telegram Mini App магазина:",
    features: [
      "**Единый интерфейс управления**: Централизованное управление отправками через различные службы доставки прямо из админ-панели Telegram Mini App",
      "**Автоматический расчет стоимости**: Мгновенное определение оптимального способа доставки по стоимости и срокам",
      "**Печать документов**: Автоматическое формирование и печать этикеток, накладных и других сопроводительных документов",
      "**Трекинг отправлений**: Отслеживание статусов доставки с автоматическим обновлением информации в Telegram",
      "**Интеграция с маркетплейсами**: Синхронизация заказов из Mini App с Wildberries, Ozon, Яндекс.Маркет для омниканальных продаж"
    ],
    impact: "Внедрение модуля сокращает время обработки заказов на 75% и минимизирует ошибки при оформлении документов до менее чем 0,5%, позволяя эффективно масштабировать бизнес через Telegram.",
  },
  "Виртуальная примерка AR": {
    description: "Инновационная технология дополненной реальности для Telegram Mini Apps, повышающая конверсию покупок:",
    features: [
      "**Бесшовная AR-интеграция**: Работа через Telegram Mini App без необходимости установки дополнительных приложений",
      "**Высокоточное распознавание**: Автоматическое определение размеров тела и лица пользователя с точностью до 98%",
      "**Реалистичная визуализация**: Точная передача фактуры, цвета и поведения материалов в дополненной реальности",
      "**Фотофиксация примерки**: Возможность сохранения и отправки фотографий товара в интерьере или на себе прямо в чаты Telegram",
      "**Мультитоварная примерка**: Одновременная визуализация нескольких товаров для создания комплектов"
    ],
    impact: "Технология снижает количество возвратов на 40% и увеличивает конверсию посетителей в покупателей на 30%, максимально используя технические возможности Telegram для предоставления иммерсивного покупательского опыта.",
  },
  "Система промокодов и автоматических скидок": {
    description: "Мощный инструмент стимулирования продаж через гибкие механизмы ценообразования в Telegram Mini App:",
    features: [
      "**Многоуровневые скидки**: Создание сложных правил скидок с комбинированием различных условий активации",
      "**Временные ограничения**: Настройка промокодов с точным периодом действия вплоть до минут с автоматическими уведомлениями в Telegram",
      "**Персональные предложения**: Генерация уникальных одноразовых промокодов для конкретных пользователей Telegram",
      "**Автоматические скидки**: Применение скидок на основе состава корзины, истории покупок и поведения пользователя в Mini App",
      "**Защита от злоупотреблений**: Интеллектуальная система предотвращения мошенничества с промокодами"
    ],
    impact: "Правильно настроенная система скидок увеличивает средний чек на 15-25% и стимулирует повторные покупки в вашем Telegram Mini App, повышая LTV клиента.",
  },
  "Кросс-продажи с умными рекомендациями": {
    description: "Интеллектуальная система увеличения среднего чека через персонализированные предложения в Telegram:",
    features: [
      "**Алгоритмы машинного обучения**: Анализ покупательских паттернов в Mini App для выявления неочевидных связей между товарами",
      "**Контекстные рекомендации**: Динамическое изменение предложений в зависимости от этапа покупки и состава корзины",
      "**Персонализированная выдача**: Формирование рекомендаций на основе предыдущих покупок и просмотров конкретного пользователя Telegram",
      "**Автоматические комплекты**: Создание готовых наборов товаров со специальной ценой для увеличения объема покупки",
      "**A/B тестирование стратегий**: Автоматический подбор оптимальных алгоритмов рекомендаций для разных категорий товаров в Mini App"
    ],
    impact: "Внедрение системы увеличивает средний чек в Telegram Mini App на 25-35% и способствует знакомству покупателей с новыми категориями товаров, максимально используя компактный интерфейс мессенджера.",
  },
  "Быстрый повтор заказа в один клик": {
    description: "Инструмент повышения частоты повторных покупок в Telegram Mini App за счет максимального упрощения процесса:",
    features: [
      "**Шаблоны заказов**: Сохранение истории заказов с возможностью быстрого повторения в один клик прямо из Telegram",
      "**Умные напоминания**: Автоматическое определение оптимального момента для напоминания о повторной покупке через Telegram Bot",
      "**Предзаполненные формы**: Сохранение всех данных для оформления без повторного ввода адреса и способа оплаты",
      "**Расходные материалы**: Интеллектуальное отслеживание периодичности заказов расходников с предложением пополнения через Telegram",
      "**Экспресс-доставка**: Приоритетная обработка повторных заказов с минимальным временем доставки"
    ],
    impact: "Функционал повышает частоту повторных покупок на 60% и значительно сокращает время от намерения до оплаты заказа, максимально используя преимущества экосистемы Telegram для удержания клиентов.",
  },
  "Кружочки сторис с интерактивными элементами": {
    description: "Современный формат контента для повышения вовлеченности и времени в приложении:",
    features: [
      "**Интеграция с Telegram**: Возможность делиться понравившимися сториз в личные чаты и групповые каналы Telegram",
      "**Аналитика просмотров**: Детальная статистика по охвату, завершенности просмотров, взаимодействиям и конверсии",
      "**Интерактивные call-to-action**: Встроенные кнопки, формы, опросы и ссылки для стимулирования целевых действий пользователя",
      "**Разнообразный контент**: Поддержка фото, видео, анимаций, текстовых наложений и интерактивных элементов в едином формате",
      "**Вертикальный формат историй**: Полноэкранные истории в стиле Instagram с плавными переходами и интуитивной навигацией через тапы и свайпы"
    ],
    impact: "Stories увеличивают время в приложении на 50% и повышают вовлеченность на 65%, создавая привлекательный и знакомый пользователям формат контента в Telegram Mini App.",
  },
  "Корпоративный портал 'в кармане'": {
    description: "Комплексное решение для внутренних коммуникаций и рабочих процессов, полностью интегрированное в Telegram:",
    features: [
      "**Структура компании и контакты**: Интерактивная схема организационной структуры с поиском сотрудников, их должностей и контактов прямо в Mini App",
      "**База знаний компании**: Централизованное хранилище регламентов, инструкций и шаблонов документов с умным семантическим поиском",
      "**Заказ справок и документов**: Автоматизированная подача заявок в бухгалтерию или HR-отдел (справка 2-НДФЛ, справка с места работы) с отслеживанием статуса через Telegram-бота",
      "**Календарь корпоративных событий**: Общий календарь с возможностью подписки на уведомления о днях рождения коллег, корпоративах и важных встречах",
      "**Онбординг новых сотрудников**: Автоматизированные приветственные цепочки и чек-листы задач для быстрой адаптации новичков"
    ],
    impact: "Решение сокращает время на поиск информации и решение рутинных кадровых вопросов на 60%, повышая вовлеченность и информированность сотрудников.",
  }
};

export function ModuleModal({ module, isOpen, onClose }: ModuleModalProps) {
  // Используем реальные данные модуля
  const details = {
    description: module?.description || "",
    features: module?.keyFeatures?.split('\n').filter(f => f.trim()) || [
      "Основные возможности модуля",
      "Быстрое внедрение в ваш проект", 
      "Техническая поддержка при настройке"
    ],
    impact: module?.benefits || ""
  };

  if (!module) return null;

  return (
    <Dialog open={isOpen} onOpenChange={onClose}>
      <DialogContent className="max-w-4xl max-h-[90vh] overflow-y-auto">
        <DialogHeader>
          <DialogTitle className="text-2xl font-bold">{module.name}</DialogTitle>

          <div className="flex items-center gap-2 mt-2">
            {module.isPopular && (
              <Badge className="bg-orange-100 text-orange-800">Популярный</Badge>
            )}
          </div>
        </DialogHeader>

        {/* Module Header with Description */}
        <div className="p-6 rounded-lg bg-gradient-to-r from-blue-50 to-blue-100 border border-blue-200">
          <p className="text-gray-700 text-lg leading-relaxed">
            {details.description}
          </p>
        </div>

        <div className="mt-6 space-y-4">
          <Card>
            <CardHeader>
              <CardTitle className="flex items-center gap-2">
                <Zap className="w-5 h-5 text-telegram" />
                Что умеет модуль
              </CardTitle>
            </CardHeader>
            <CardContent>
              <ul className="space-y-3">
                {details.features.map((feature: string, index: number) => (
                  <li key={index} className="flex items-start gap-3">
                    <CheckCircle className="w-5 h-5 text-success mt-0.5 flex-shrink-0" />
                    <span 
                      className="text-gray-700"
                      dangerouslySetInnerHTML={{
                        __html: feature.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
                      }}
                    />
                  </li>
                ))}
              </ul>
            </CardContent>
          </Card>

          {/* Interactive Before/After Demo */}
          <Card>
            <CardHeader>
              <CardTitle className="flex items-center gap-2">
                <Play className="w-5 h-5 text-telegram" />
                Интерактивная демонстрация
              </CardTitle>
            </CardHeader>
            <CardContent>
              <BeforeAfterDemo moduleName={module.name} />
            </CardContent>
          </Card>

          {/* Interactive Pain Points Section */}
          <ModulePainPoints moduleName={module.name} />

          {details.impact && (
            <Card>
              <CardHeader>
                <CardTitle className="flex items-center gap-2">
                  <TrendingUp className="w-5 h-5 text-green-600" />
                  Преимущества для бизнеса
                </CardTitle>
              </CardHeader>
              <CardContent>
                <p className="text-gray-700">{details.impact}</p>
              </CardContent>
            </Card>
          )}



          <div className="flex gap-4">
            <Button className="flex-1 bg-telegram hover:bg-telegram/90 text-white">
              Подключить модуль
            </Button>
            <Button variant="outline" onClick={onClose}>
              Закрыть
            </Button>
          </div>
        </div>
      </DialogContent>
    </Dialog>
  );
}